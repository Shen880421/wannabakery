<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³¼ç‰©è»Š</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../src/css/CSS_reset.css">
    <!-- å­—å‹ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Just+Me+Again+Down+Here&family=LXGW+WenKai+Mono+TC&family=Shadows+Into+Light&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&display=swap" rel="stylesheet">
    <!-- å­—å‹ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
    <link rel="stylesheet" href="../src/css/wannabakery.css">
    <style>
        /*å¢åŠ ç”¢å“è¢«é¸æ“‡æ™‚çš„æ˜é¡¯ç‹€æ…‹*/
        .prod-card.selected {
            border-color: #B6C4CE;
            background-color: #DDEBE5;
        }
    </style>
</head>

<body>
    <nav class="container-fuid nav_top">
        <div class="row col-12">
            <div class="row nav_logoname col-4">
                <div class="col-5 nav_logoimg">
                    <img src="../src/img/wannabakerylogo.jpg" class="logo_size">
                </div>
                <div class="col-7 text-start">
                    <div class="bakeryname">Wannabakery</div>
                </div>
            </div>
            <div class="col-8 text-end nav_button">
                <a href="wannabakery.html" role="button" type="button" class="btn btn_customcolor" autocomplete="off"
                    aria-pressed="true">é¦–é </a>
                <a href="../index.html" role="button" type="button" class="btn btn_customcolor"
                    autocomplete="off">è¯çµ¡æˆ‘å€‘</a>
                <a role="button" type="button" class="btn btn_customcolor" autocomplete="off">ç”¢å“ä»‹ç´¹</a>
                <a href="bakerycart.html" type="button" role="button" class="btn btn_customcolor active"
                    autocomplete="off">è³¼ç‰©è»Š</a>
            </div>
        </div>
    </nav>
    <form id="orderform" class="needs-validation" novalidate>
        <!--ç”¢å“è³‡è¨Šå€å¡ŠåŠé é¢æ¨™é¡Œ-->
        <section class="container mt-4">
            <h1 class="text-center">è³¼ç‰©è»Š</h1>

            <!-- <div class="alert alert-info alert-dismissible fade show" role="alert">
                <strong>æé†’ï¼š</strong> è«‹ç¢ºèªä»¥ä¸‹æ¬„ä½æ˜¯å¦æ­£ç¢ºã€‚
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="é—œé–‰"></button>
            </div> -->
            <div class="card">
                <div class="card-header mint">
                    <h4>é¸æ“‡ç”¢å“</h4>
                </div>
                <div class="card-body">
                    <div class="row row-cols-1 row-cols-md-3 " id=productList>

                    </div>
                    <div class="form-check mt-1">
                        <input type="checkbox" class="form-check-input" id="warranty">
                        <label for="warranty" class="form-check-lable">ç¦®ç›’åŒ…è£æœå‹™ +NT$100</label>
                        <div class="text-end"><br>ç”œé»çš†éœ€å†·å‡/è—å®…é… é‹è²»+NT$80</div>
                    </div>
                </div>
            </div>
            <div class="card">
                <h2>ğŸ›’ è³¼ç‰©è»Š</h2>
                <ul id="cartList"></ul>
                <p><strong>ç¸½é‡‘é¡ï¼š</strong><span id="total">0</span> å…ƒ</p>
            </div>

        </section>
        <!--æ¶ˆè²»è€…è³‡è¨Š-->
        <section class="container mt-4">
            <div class="row">
                <div class="col-12 col-md-6">
                    <div class="card">
                        <div class="card-header mint">å®¢æˆ¶è³‡è¨Š</div>
                        <div class="card-body">
                            <div class="cname-div">
                                <label for="cname" class="form-check-label">è³¼è²·äººå§“å</label>
                                <input id="cname" name="canme" class="form-control" required>
                                <div class="invalid-feedback">
                                    è«‹è¼¸å…¥æ‚¨çš„å§“å
                                </div>
                            </div>
                            <div class="cemail-div mt-2">
                                <label for="cemail" class="form-check-label">è³¼è²·äººé›»éƒµ</label>
                                <input id="cemail" name="cemail" class="form-control" required>
                                <div class="invalid-feedback">
                                    è«‹è¼¸å…¥æ‚¨çš„email
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="card">
                        <div class="card-header mint">é…é€è³‡è¨Š</div>
                        <div class="card-body">
                            <div class="city-div">
                                <label for="ccity" class="form-check-label">ç¸£å¸‚</label>
                                <select class="form-select" id="ccity" name="ccity" onchange="updateDistricts()"
                                    required>
                                    <option value="">---è«‹é¸æ“‡---</option>
                                </select>
                                <div class="invalid-feedback">è«‹é¸æ“‡ç¸£å¸‚</div>
                            </div>

                            <div class="district-div mt-2">
                                <label for="cdistrict" class="form-check-label">è¡Œæ”¿å€åŸŸ</label>
                                <select id="cdistrict" name="cdistrict" class="form-select" required>
                                    <option value="">---è«‹å…ˆé¸æ“‡ç¸£å¸‚---</option>
                                </select>
                                <div class="invalid-feedback">è«‹é¸æ“‡è¡Œæ”¿å€</div>
                            </div>

                            <div class="caddr-div mt-2">
                                <label for="caddr" class="form-check-label">åœ°å€</label>
                                <input id="caddr" name="caddr" class="form-control" required>
                                <div class="invalid-feedback">è«‹è¼¸å…¥æ‚¨çš„åœ°å€è·¯åé–€ç‰Œ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--ä»˜æ¬¾æ–¹å¼-->
        <section class="container mt-4">
            <div class="card">
                <div class="card-header mint">æ”¯ä»˜æ–¹å¼</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-12 col-md-6">
                            <!--ä¿¡ç”¨å¡æ”¯ä»˜å·¥å…·-->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="creditcard"
                                    value="creditcard">
                                <label class="form-check-label" for="creditcard">ä¿¡ç”¨å¡/Debitå¡</label>
                            </div>
                            <div class="cardnumber-info">
                                <label>å¡è™Ÿ</label>
                                <input type="text" class="form-control" id="cardNumber" name="cardNumber"
                                    placeholder="xxxx xxxx xxxx xxxx">
                            </div>
                            <div class="card-info mt-4">
                                <div class="row">
                                    <div class="col-12 col-md-6">
                                        <label for="exDate" class="form-label">åˆ°æœŸæœˆ/å¹´</label>
                                        <input type="text" class="form-control" id="exDate" name="exDate"
                                            placeholder="MM/YY">
                                        <div class="invalid-feedback">
                                            ä¿¡ç”¨å¡å¡è™Ÿéœ€è¦è¼¸å…¥
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label for="cvv" class="form-label">cvv</label>
                                        <input class="form-control" type="text" id="cvv" name="cvv">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <!--å…¶ä»–æ”¯ä»˜å·¥å…·-->
                            <div class="mt-4">
                                <input type="radio" id="linepay" name="paymentMethod" value="linepay" checked>
                                <label for="linepay" class="form-check-label">LinePay</label>
                            </div>
                            <div class="mt-4">
                                <input type="radio" id="atm" name="paymentMethod" value="atm">
                                <label for="atm" class="form-check-label">ATM</label>
                            </div>
                            <div class="mt-4">
                                <input type="radio" id="cod" name="paymentMethod" value="cod">
                                <label for="cod" class="form-check-label">è²¨åˆ°ä»˜æ¬¾</label>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
        <!--è¨‚å–®æ˜ç´°-->
        <section class="container mt-4">
            <div class="card">
                <div class="card-header mint">è¨‚å–®æ‘˜è¦</div>
                <div class="card-body">
                    <div class="order-summary">
                        <div class="row mt-2">
                            <div class="col-7">ç¦®ç›’åŒ…è£æœå‹™</div>
                            <div class="col-5 text-end" id="warrantyPrice">ä¸éœ€åŒ…è£</div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-7">é‹è²»</div>
                            <div class="col-5 text-end" id="shippingfee">å†·è—/å‡é‹è²»NT$80</div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-7">ç¸½è¨ˆ</div>
                            <div class="col-5 text-end" id="ALLtotalPrice">NT$0</div>
                        </div>
                    </div>
                    <div class="form-check mt-2">
                        <input type="checkbox" class="form-check-input" id="term" name="term" required>
                        <label for="term" class="form-check-label">
                            æˆ‘å·²é–±è®€ä¸”åŒæ„<a href="javascript:;">æœå‹™æ¢æ¬¾</a>åŠ<a href="javascript:;">éš±ç§æ”¿ç­–</a>
                        </label>
                        <div class="invalid-feedback">æ‚¨å¿…é ˆåŒæ„æ‰èƒ½é€²è¡Œçµå¸³.</div>
                    </div>
                    <div class="mt-2 d-grid">
                        <button type="submit" class="btn btn_customcolor btn-lg">çµå¸³</button>
                    </div>
                </div>

            </div>
            </div>
        </section>

    </form>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>/*ç¸£å¸‚å€åŸŸ*/
        let addressData = []; // ç”¨ä¾†å­˜æ”¾APIè³‡æ–™

        async function loadAddressData() {
            try {
                const response = await fetch("../src/data/CityCountyData.json"); // è«‹æ›æˆä½ çœŸæ­£çš„API URL
                addressData = await response.json();

                const citySelect = document.getElementById("ccity");

                // å°‡æ‰€æœ‰ç¸£å¸‚åŠ å…¥ä¸‹æ‹‰é¸å–®
                addressData.forEach(city => {
                    const option = document.createElement("option");
                    option.value = city.CityName;
                    option.textContent = city.CityName;
                    citySelect.appendChild(option);
                });
            } catch (error) {
                console.error("è¼‰å…¥ç¸£å¸‚è³‡æ–™éŒ¯èª¤:", error);
            }
        }

        function updateDistricts() {
            const citySelect = document.getElementById("ccity");
            const districtSelect = document.getElementById("cdistrict");
            const selectedCity = citySelect.value;

            // æ¸…ç©ºè¡Œæ”¿å€é¸å–®
            districtSelect.innerHTML = '<option value="">---è«‹é¸æ“‡è¡Œæ”¿å€---</option>';

            if (!selectedCity) return;

            // æ‰¾åˆ°é¸ä¸­çš„ç¸£å¸‚è³‡æ–™
            const cityData = addressData.find(city => city.CityName === selectedCity);

            if (cityData) {
                cityData.AreaList.forEach(area => {
                    const option = document.createElement("option");
                    option.value = area.AreaName;
                    option.textContent = area.AreaName;
                    districtSelect.appendChild(option);
                });
            }
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        window.addEventListener("DOMContentLoaded", loadAddressData);
    </script>
    <script>
        const productList = document.getElementById('productList');
        const cartList = document.getElementById('cartList');
        const total = document.getElementById('total');
        let cart = [];

        // ğŸ” å¾ JSON æª”æ¡ˆè¼‰å…¥å•†å“è³‡æ–™
        fetch('../src/data/products.json')
            .then(res => res.json())
            .then(data => {
                data.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'product';
                    div.innerHTML = `
          <img src="${product.image_url}" width="100"><br>
          <h3>${product.name}</h3>
          <p>åƒ¹æ ¼ï¼š${product.price} å…ƒ</p>
          <button type ="button" onclick='addToCart(${JSON.stringify(product)})'>åŠ å…¥è³¼ç‰©è»Š</button>
        `;
                    productList.appendChild(div);
                });
            });

        function addToCart(product) {
            const existing = cart.find(item => item.id === product.id);
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            renderCart();
        }

        function renderCart() {
            cartList.innerHTML = '';
            let totalPrice = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);


            cart.forEach((item, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
        ${item.name} x ${item.quantity} = ${item.price * item.quantity} å…ƒ
        <button type ="button" onclick="increaseQuantity(${index})">ï¼‹</button>
        <button type ="button" onclick="decreaseQuantity(${index})">ï¼</button>
        <button type ="button" onclick="removeItem(${index})">ç§»é™¤</button>
      `;
                cartList.appendChild(li);
                totalPrice += item.price * item.quantity;
            });

            let warrantyFee = document.getElementById('warranty').checked ? 100 : 0;
            let shippingFee = 80; 
            total.textContent = (totalPrice).toFixed(2);
            document.getElementById('warrantyPrice').textContent = warrantyFee ? 'NT$100' : 'ä¸éœ€åŒ…è£';
            document.getElementById('ALLtotalPrice').textContent = `NT$${(totalPrice + warrantyFee + shippingFee).toFixed(2)}`;
        }

        function increaseQuantity(index) {
            cart[index].quantity++;
            renderCart();
        }

        function decreaseQuantity(index) {
            if (cart[index].quantity > 1) {
                cart[index].quantity--;
            } else {
                removeItem(index);
            }
            renderCart();
        }

        function removeItem(index) {
            cart.splice(index, 1);
            renderCart();
        }
        document.getElementById('warranty').addEventListener('change', renderCart);
    </script>

</body>

</html>